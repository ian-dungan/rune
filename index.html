<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Rune-Like (Starter)</title>
  <link rel="icon" href="./favicon.ico" />
  <link rel="stylesheet" href="./styles.css" />
  <meta name="color-scheme" content="dark">
</head>
<body>
  <div id="app">
    <header class="topbar">
      <div class="brand">
        <div class="logo"></div>
        <div class="brandText">
          <div class="brandTitle">Rune‑Like</div>
          <div class="brandSub">2D MMO starter • GitHub Pages + Supabase</div>
        </div>
      </div>
      <div class="topbarRight">
        <button id="btnLogout" class="btn ghost" title="Sign out">Logout</button>
      </div>
    </header>

    <main id="screenAuth" class="screen">
      <div class="authCard">
        <div class="authTabs">
          <button id="tabLogin" class="tab active">Login</button>
          <button id="tabSignup" class="tab">Create Account</button>
        </div>

        <div class="authBody">
          <div class="field">
            <label>Username</label>
            <input id="authUsername" autocomplete="username" spellcheck="false" maxlength="16" placeholder="e.g. ian123" />
            <div class="hint">3–16 chars. Letters, numbers, underscore.</div>
          </div>
          <div class="field">
            <label>Password</label>
            <input id="authPassword" type="password" autocomplete="current-password" placeholder="••••••••" />
            <div class="hint">6+ characters.</div>
          </div>

          <div id="signupExtras" class="signupExtras hidden">
            <div class="field">
              <label>Character name</label>
              <input id="charName" maxlength="16" placeholder="Shown in-game" />
            </div>

            <div class="field">
              <label>Style</label>
              <div class="styleGrid" id="styleGrid"></div>
              <div class="hint">Pick a style—more customization coming next.</div>
            </div>
          </div>

          <div class="actions">
            <button id="btnPrimary" class="btn primary">Login</button>
            <button id="btnGuest" class="btn">Enter Offline (No Supabase)</button>
          </div>

          <div id="authMsg" class="msg"></div>
        </div>

        <div class="footnote">
          Tip: if GitHub Pages caches old files, hard refresh (Ctrl+Shift+R).
        </div>
      </div>
    </main>

    <main id="screenGame" class="screen hidden">
      <div class="gameRoot">
        <canvas id="game" width="1280" height="720"></canvas>

        <div class="hud">
          <div class="hudLeft">
            <div class="panel pTop" id="panelStats">
              <div class="panelTitle">Adventurer</div>
              <div class="statsRow">
                <div class="stat">
                  <div class="statLabel">HP</div>
                  <div class="bar"><div id="hpBar" class="barFill"></div></div>
                </div>
                <div class="stat">
                  <div class="statLabel">Stam</div>
                  <div class="bar"><div id="stamBar" class="barFill"></div></div>
                </div>
              </div>
              <div class="tiny" id="whereText">Loading…</div>
            </div>

            <div class="panel pBottom" id="panelChat">
              <div class="panelTitleRow">
                <div class="panelTitle">Chat</div>
                <div class="pill" id="worldPill">World: Lobby</div>
              </div>
              <div id="chatLog" class="chatLog"></div>
              <div class="chatInputRow">
                <input id="chatInput" maxlength="200" placeholder="Press Enter to chat…" />
                <button id="chatSend" class="btn small">Send</button>
              </div>
            </div>
          </div>

          <div class="hudRight">
            <div class="panel pMinimap" id="panelMinimap">
              <div class="panelTitleRow">
                <div class="panelTitle">Map</div>
                <div class="tiny" id="fpsText">— fps</div>
              </div>
              <canvas id="minimap" width="180" height="180"></canvas>
              <div class="miniRow">
                <button id="btnZoomIn" class="btn small ghost">+</button>
                <button id="btnZoomOut" class="btn small ghost">−</button>
                <button id="btnCenter" class="btn small">Center</button>
              </div>
            </div>

            <div class="panel pInv" id="panelInv">
              <div class="panelTitleRow">
                <div class="panelTitle">Inventory</div>
                <div class="tiny">WIP</div>
              </div>
              <div class="invGrid" id="invGrid"></div>
              <div class="tiny">Soon: skills, equipment, banking, crafting.</div>
            </div>

            <div class="panel pHelp" id="panelHelp">
              <div class="panelTitle">Controls</div>
              <div class="tiny">
                • Click: move<br/>
                • WASD: nudge<br/>
                • Mouse wheel: zoom<br/>
                • Enter: chat<br/>
                • M: toggle minimap<br/>
              </div>
            </div>
          </div>
        </div>

        <div class="toast" id="toast"></div>
      </div>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script type="module" src="./app.js?v=20251219-2"></script>
</body>
</html>
